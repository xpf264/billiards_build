System.register("chunks:///_virtual/billiards_wasm.js",["./cjs-loader.mjs"],(function(t,e){var r;return{setters:[function(t){r=t.default}],execute:function(){function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */n=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",f=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new j(n||[]);return i(a,"_invoke",{value:k(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",v="executing",d="completed",y={};function g(){}function m(){}function w(){}var b={};s(b,u,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(R([])));_&&_!==r&&o.call(_,u)&&(b=_);var E=w.prototype=g.prototype=Object.create(b);function A(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(n,i,a,u){var c=h(t[n],t,i);if("throw"!==c.type){var f=c.arg,s=f.value;return s&&"object"==typeof s&&o.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(s).then((function(t){f.value=t,a(f)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var n;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}})}function k(e,r,n){var o=p;return function(i,a){if(o===v)throw new Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=L(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var f=h(e,r,n);if("normal"===f.type){if(o=n.done?d:"suspendedYield",f.arg===y)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=d,n.method="throw",n.arg=f.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function R(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(o.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(typeof e+" is not iterable")}return m.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,f,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,f,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},A(S.prototype),s(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},A(E),s(E,f,"Generator"),s(E,u,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=R,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),f=o.call(a,"finallyLoc");if(c&&f){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:R(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function o(){return(o=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function i(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function u(t){i(a,n,o,u,c,"next",t)}function c(t){i(a,n,o,u,c,"throw",t)}u(void 0)}))}}t("default",void 0);var u=t("__cjsMetaURL",e.meta.url);r.define(u,(function(e,r,i,u,c){var f,s,l=(s="undefined"!=typeof document?null==(f=document.currentScript)?void 0:f.src:void 0,a(n().mark((function t(e){var r,i,u,c,f,l,h,p,v,d,y,g,m,w,b,x,_,E,A,S,k,L,P,O,j,R,T,C,I,D,B,F,H,N,M,U,G,z,W,Y,q,J,K,X,Q,V,Z,$,tt,et,rt,nt,ot,it,at,ut,ct,ft,st,lt,ht,pt;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(pt=function(){function t(){if(i.calledRun=!0,!x){if(ct.u(),u(i),null==i.onRuntimeInitialized||i.onRuntimeInitialized(),i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;){var t=i.postRun.shift();U.unshift(t)}M(U)}}if(0<O)j=pt;else{if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)z();M(G),0<O?j=pt:i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){return i.setStatus("")}),1),t()}),1)):t()}},H=function(){return(H=a(n().mark((function t(e){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=T,w||"function"!=typeof WebAssembly.instantiateStreaming){t.next=12;break}return t.prev=2,o=fetch(r,{credentials:"same-origin"}),t.next=6,WebAssembly.instantiateStreaming(o,e);case 6:return t.abrupt("return",t.sent);case 9:t.prev=9,t.t0=t.catch(2),m("wasm streaming compile failed: "+t.t0),m("falling back to ArrayBuffer instantiation");case 12:return t.abrupt("return",D(r,e));case 13:case"end":return t.stop()}}),t,null,[[2,9]])})))).apply(this,arguments)},F=function(t){return H.apply(this,arguments)},B=function(){return(B=a(n().mark((function t(e,r){var o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C(e);case 3:return o=t.sent,t.next=6,WebAssembly.instantiate(o,r);case 6:return t.abrupt("return",t.sent);case 9:t.prev=9,t.t0=t.catch(0),m("failed to asynchronously prepare wasm: "+t.t0),R(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))).apply(this,arguments)},D=function(t,e){return B.apply(this,arguments)},I=function(){return(I=a(n().mark((function t(e){var r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(w){t.next=10;break}return t.prev=1,t.next=4,d(e);case 4:return r=t.sent,t.abrupt("return",new Uint8Array(r));case 8:t.prev=8,t.t0=t.catch(1);case 10:if(e!=T||!w){t.next=14;break}e=new Uint8Array(w),t.next=19;break;case 14:if(!y){t.next=18;break}e=y(e),t.next=19;break;case 18:throw"both async and sync fetching of the wasm failed";case 19:return t.abrupt("return",e);case 20:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)},C=function(t){return I.apply(this,arguments)},R=function(t){throw null==i.onAbort||i.onAbort(t),m(t="Aborted("+t+")"),x=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),c(t),t},P=function(){var t=b.buffer;i.HEAP8=E=new Int8Array(t),i.HEAP16=new Int16Array(t),i.HEAPU8=A=new Uint8Array(t),i.HEAPU16=new Uint16Array(t),i.HEAP32=S=new Int32Array(t),i.HEAPU32=k=new Uint32Array(t),i.HEAPF32=new Float32Array(t),i.HEAPF64=new Float64Array(t),i.HEAP64=L=new BigInt64Array(t),i.HEAPU64=new BigUint64Array(t)},void 0===e&&(e={}),i=e,f=new Promise((function(t,e){u=t,c=e})),l="undefined"!=typeof WorkerGlobalScope,h=o({},i),p="./this.program",v="",("object"==typeof window||l)&&(l?v=self.location.href:"undefined"!=typeof document&&document.currentScript&&(v=document.currentScript.src),s&&(v=s),v=v.startsWith("blob:")?"":v.slice(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1),l&&(y=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),d=function(){var t=a(n().mark((function t(e){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e,{credentials:"same-origin"});case 2:if(!(e=t.sent).ok){t.next=5;break}return t.abrupt("return",e.arrayBuffer());case 5:throw Error(e.status+" : "+e.url);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),g=i.print||console.log.bind(console),m=i.printErr||console.error.bind(console),Object.assign(i,h),h=null,i.thisProgram&&(p=i.thisProgram),w=i.wasmBinary,x=!1,O=0,j=null,N=function(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t},M=function(t){for(;0<t.length;)t.shift()(i)},U=[],G=[],z=function(){var t=i.preRun.shift();G.unshift(t)},W=i.noExitRuntime||!0,Y=function(t){this.H=t-24},q="undefined"!=typeof TextDecoder?new TextDecoder:void 0,J=function(t,e){void 0===e&&(e=0);for(var r=e+NaN,n=e;t[n]&&!(n>=r);)++n;if(16<n-e&&t.buffer&&q)return q.decode(t.subarray(e,n));for(r="";e<n;){var o=t[e++];if(128&o){var i=63&t[e++];if(192==(224&o))r+=String.fromCharCode((31&o)<<6|i);else{var a=63&t[e++];65536>(o=224==(240&o)?(15&o)<<12|i<<6|a:(7&o)<<18|i<<12|a<<6|63&t[e++])?r+=String.fromCharCode(o):(o-=65536,r+=String.fromCharCode(55296|o>>10,56320|1023&o))}}else r+=String.fromCharCode(o)}return r},K=0,X=[0,31,60,91,121,152,182,213,244,274,305,335],Q=[0,31,59,90,120,151,181,212,243,273,304,334],V={},Z=function(t){if(!(t instanceof N||"unwind"==t))throw t},tt=function(t){if(!x)try{if(t(),!(W||0<K))try{_=t=_,$(t)}catch(t){Z(t)}}catch(t){Z(t)}},et=function(t,e,r){var n=A;if(0<r){r=e+r-1;for(var o=0;o<t.length;++o){var i=t.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&t.charCodeAt(++o)),127>=i){if(e>=r)break;n[e++]=i}else{if(2047>=i){if(e+1>=r)break;n[e++]=192|i>>6}else{if(65535>=i){if(e+2>=r)break;n[e++]=224|i>>12}else{if(e+3>=r)break;n[e++]=240|i>>18,n[e++]=128|i>>12&63}n[e++]=128|i>>6&63}n[e++]=128|63&i}}n[e]=0}},rt={},nt=function(){if(!ot){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(t in rt)void 0===rt[t]?delete e[t]:e[t]=rt[t];var r=[];for(t in e)r.push(t+"="+e[t]);ot=r}return ot},it=[null,[],[]],at=function(t,e,r,n){var o={string:function(t){var e=0;if(null!=t&&0!==t){for(var r=e=0;r<t.length;++r){var n=t.charCodeAt(r);127>=n?e++:2047>=n?e+=2:55296<=n&&57343>=n?(e+=4,++r):e+=3}r=lt(e+=1),et(t,r,e),e=r}return e},array:function(t){var e=lt(t.length);return E.set(t,e),e}};t=i["_"+t];var a,u=[],c=0;if(n)for(var f=0;f<n.length;f++){var s=o[r[f]];s?(0===c&&(c=ht()),u[f]=s(n[f])):u[f]=n[f]}return r=t.apply(void 0,u),a=r,0!==c&&st(c),"string"===e?a?J(A,a):"":"boolean"===e?!!a:a},ut={a:function(t,e,r){var n=new Y(t);throw k[n.H+16>>2]=0,k[n.H+4>>2]=e,k[n.H+8>>2]=r,t},b:function(){return 0},e:function(){return 0},g:function(){},p:function(){return R("")},l:function(){W=!1,K=0},i:function(t,e){t=-9007199254740992>t||9007199254740992<t?NaN:Number(t),t=new Date(1e3*t),S[e>>2]=t.getSeconds(),S[e+4>>2]=t.getMinutes(),S[e+8>>2]=t.getHours(),S[e+12>>2]=t.getDate(),S[e+16>>2]=t.getMonth(),S[e+20>>2]=t.getFullYear()-1900,S[e+24>>2]=t.getDay();var r=t.getFullYear();S[e+28>>2]=(0!=r%4||0==r%100&&0!=r%400?Q:X)[t.getMonth()]+t.getDate()-1|0,S[e+36>>2]=-60*t.getTimezoneOffset(),r=new Date(t.getFullYear(),6,1).getTimezoneOffset();var n=new Date(t.getFullYear(),0,1).getTimezoneOffset();S[e+32>>2]=0|(r!=n&&t.getTimezoneOffset()==Math.min(n,r))},m:function(t,e){if(V[t]&&(clearTimeout(V[t].id),delete V[t]),!e)return 0;var r=setTimeout((function(){delete V[t],tt((function(){return ft(t,performance.now())}))}),e);return V[t]={id:r,M:e},0},j:function(t,e,r,n){var o=(new Date).getFullYear(),i=new Date(o,0,1).getTimezoneOffset();o=new Date(o,6,1).getTimezoneOffset(),k[t>>2]=60*Math.max(i,o),S[e>>2]=Number(i!=o),t=(e=function(t){var e=Math.abs(t);return"UTC"+(0<=t?"-":"+")+String(Math.floor(e/60)).padStart(2,"0")+String(e%60).padStart(2,"0")})(i),e=e(o),o<i?(et(t,r,17),et(e,n,17)):(et(t,n,17),et(e,r,17))},h:function(t,e,r){return 0<=t&&3>=t?(L[r>>3]=BigInt(Math.round(1e6*(0===t?Date.now():performance.now()))),0):28},s:function(){return Date.now()},f:function(t){var e=A.length;if(2147483648<(t>>>=0))return!1;for(var r=1;4>=r;r*=2){var n=e*(1+.2/r);n=Math.min(n,t+100663296);t:{n=(Math.min(2147483648,65536*Math.ceil(Math.max(t,n)/65536))-b.buffer.byteLength+65535)/65536|0;try{b.grow(n),P();var o=1;break t}catch(t){}o=void 0}if(o)return!0}return!1},n:function(t,e){var r=0;return nt().forEach((function(n,o){var i=e+r;for(o=k[t+4*o>>2]=i,i=0;i<n.length;++i)E[o++]=n.charCodeAt(i);E[o]=0,r+=n.length+1})),0},o:function(t,e){var r=nt();k[t>>2]=r.length;var n=0;return r.forEach((function(t){return n+=t.length+1})),k[e>>2]=n,0},c:function(){return 52},d:function(){return 52},q:function(){return 70},r:function(t,e,r,n){for(var o=0,i=0;i<r;i++){var a=k[e>>2],u=k[e+4>>2];e+=8;for(var c=0;c<u;c++){var f=A[a+c],s=it[t];0===f||10===f?((1===t?g:m)(J(s)),s.length=0):s.push(f)}o+=u}return k[n>>2]=o,0},k:$=function(t){throw _=t,W||0<K||(null!=i.onExit&&i.onExit(t),x=!0),new N(t)}},a(n().mark((function t(){var e,r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=function(t){return ct=t.exports,b=ct.t,P(),O--,null==i.monitorRunDependencies||i.monitorRunDependencies(O),0==O&&j&&(t=j,j=null,t()),ct},O++,null==i.monitorRunDependencies||i.monitorRunDependencies(O),r={a:ut},!i.instantiateWasm){t.next=6;break}return t.abrupt("return",new Promise((function(t){i.instantiateWasm(r,(function(r,n){e(r,n),t(r.exports)}))})));case 6:return null!=T||(T=i.locateFile?i.locateFile("billiards_wasm.wasm",v):v+"billiards_wasm.wasm"),t.prev=7,t.next=10,F(r);case 10:return o=t.sent,t.abrupt("return",e(o.instance));case 14:return t.prev=14,t.t0=t.catch(7),t.abrupt("return",(c(t.t0),Promise.reject(t.t0)));case 17:case"end":return t.stop()}}),t,null,[[7,14]])})))(),i._initSimulation=function(){return(i._initSimulation=ct.v)()},i._setupStandardBalls=function(){return(i._setupStandardBalls=ct.w)()},i._clearBalls=function(){return(i._clearBalls=ct.x)()},i._addBall=function(t,e,r){return(i._addBall=ct.y)(t,e,r)},i._resetCueBall=function(t,e){return(i._resetCueBall=ct.z)(t,e)},i._cleanupSimulation=function(){return(i._cleanupSimulation=ct.A)()},i._executeCueStrike=function(t,e,r,n,o){return(i._executeCueStrike=ct.B)(t,e,r,n,o)},i._calculateAimingPath=function(t,e){return(i._calculateAimingPath=ct.C)(t,e)},i._stepSimulation=function(){return(i._stepSimulation=ct.D)()},i._getPhysicsConfig=function(){return(i._getPhysicsConfig=ct.E)()},i._getTableConfig=function(){return(i._getTableConfig=ct.F)()},i._getBoundarySegments=function(){return(i._getBoundarySegments=ct.G)()},ft=function(t,e){return(ft=ct.I)(t,e)},st=function(t){return(st=ct.J)(t)},lt=function(t){return(lt=ct.K)(t)},ht=function(){return(ht=ct.L)()},i.ASSERTIONS=0,i.ccall=at,i.cwrap=function(t,e,r,n){var o=!r||r.every((function(t){return"number"===t||"boolean"===t}));return"string"!==e&&o&&!n?i["_"+t]:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return at(t,e,r,o)}},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.pop()();return pt(),r=f,t.abrupt("return",r);case 43:case"end":return t.stop()}}),t)}))));"object"==typeof e&&"object"==typeof i?(i.exports=l,i.exports.default=l):"function"==typeof define&&define.amd&&define([],(function(){return l})),t("default",i.exports),i.exports.default}),{})}}}));

System.register("chunks:///_virtual/billiards_wasm.mjs_cjs=&original=.js",["./billiards_wasm.js","./cjs-loader.mjs"],(function(s,a){var e,r;return{setters:[function(a){e=a.__cjsMetaURL;var r={};r.__cjsMetaURL=a.__cjsMetaURL,r.default=a.default,s(r)},function(s){r=s.default}],execute:function(){e||r.throwInvalidWrapper("./billiards_wasm.js",a.meta.url),r.require(e)}}}));

System.register("chunks:///_virtual/main",["./Start.ts","./WasmLoader.ts","./WasmWrapper.ts","./billiards_wasm.mjs_cjs=&original=.js"],(function(){return{setters:[null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/Start.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WasmLoader.ts"],(function(e){var t,n,i,o,s,a,l,h,r,c,d,u,g,p,y,S,m;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e._decorator,o=e.Node,s=e.view,a=e.Camera,l=e.UITransform,h=e.Slider,r=e.Label,c=e.Vec3,d=e.Vec2,u=e.Graphics,g=e.Color,p=e.Component},function(e){y=e.wasmEventTarget,S=e.WASM_EVENTS,m=e.WasmGlobal}],execute:function(){var B;n._RF.push({},"e1bc58B4aVATL8eucrEV4CA","Start",void 0);var C=i.ccclass;i.property,e("Start",C("Start")(B=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).physicsToScreenScale=1,t.ballNodes=[],t.wasmInstance=null,t.cueBallPosition=new d(0,0),t.allStoped=!0,t.isAddingBall=!1,t.angle=0,t}t(n,e);var i=n.prototype;return i.start=function(){},i.onLoad=function(){y.on(S.INIT_SUCCESS,this.onWasmInitSuccess,this),this.node.getChildByName("addButton").on(o.EventType.TOUCH_END,this.handlerAddButton,this),this.node.getChildByName("minusButton").on(o.EventType.TOUCH_END,this.handlerMinusButton,this),this.node.getChildByName("strikeButton").on(o.EventType.TOUCH_END,this.handlerPlayButton,this),this.node.getChildByName("resetButton").on(o.EventType.TOUCH_END,this.handlerResetButton,this),this.node.getChildByName("addBallButton").on(o.EventType.TOUCH_END,this.handlerAddBall,this),this.node.getChildByName("cueBallButton").on(o.EventType.TOUCH_END,this.handlerCueBall,this),this.node.getChildByName("clearBallsButton").on(o.EventType.TOUCH_END,this.handlerClearBalls,this),this.node.getChildByName("powerSlider").on("slide",this.handlerPowerSlider,this),this.node.getChildByName("spinTopSlider").on("slide",this.handlerSpinTopSlider,this),this.node.getChildByName("spinZSlider").on("slide",this.handlerSpinZSlider,this);var e=s.getVisibleSize();console.log("实际视口大小: "+e.width+"×"+e.height);var t=this.node.scene.getChildByName("Main Camera").getComponent(a).orthoHeight;console.log("透视摄像机的 orthoHeight: "+t);var n=Math.min(e.height,e.width);this.physicsToScreenScale=n/(2*t),console.log("physicsToScreenScale: "+this.physicsToScreenScale);for(var i=this.node.parent.getChildByName("balls"),h=0;h<16;h++){var r="";r=0==h?"BallCue.LOD2":"Ball"+h+".LOD2",this.ballNodes[h]=i.getChildByName(r),this.ballNodes[h].active=!1}i.active=!0;var c=this.node.getChildByName("touchNode"),d=c.getComponent(l);d.width=2.511*this.physicsToScreenScale,d.height=1.241*this.physicsToScreenScale,console.log("touchNode width:",d.width),console.log("touchNode height:",d.height),c.on(o.EventType.TOUCH_END,this.handlerTouchEnd,this)},i.handlerPowerSlider=function(e){var t=(10*this.node.getChildByName("powerSlider").getComponent(h).progress).toFixed(2);this.node.getChildByName("powerSlider").getChildByName("Text").getComponent(r).string=t},i.handlerSpinTopSlider=function(e){var t=(1e3*(this.node.getChildByName("spinTopSlider").getComponent(h).progress-.5)).toFixed(2);this.node.getChildByName("spinTopSlider").getChildByName("Text").getComponent(r).string=t},i.handlerSpinZSlider=function(e){var t=(1e3*(this.node.getChildByName("spinZSlider").getComponent(h).progress-.5)).toFixed(2);this.node.getChildByName("spinZSlider").getChildByName("Text").getComponent(r).string=t},i.handlerClearBalls=function(){this.wasmInstance.clearBalls();for(var e=0;e<16;e++)this.ballNodes[e].active=!1;this.wasmInstance.addBall(0,-.685,0),this.angle=0},i.handlerCueBall=function(){this.wasmInstance.resetCueBall(-.685,0),this.angle=0},i.handlerAddBall=function(){console.log("add ball"),this.isAddingBall=!0},i.handlerResetButton=function(){this.wasmInstance.setupStandardBalls(),this.angle=0},i.onDestroy=function(){y.off(S.INIT_SUCCESS,this.onWasmInitSuccess,this)},i.onWasmInitSuccess=function(){console.log("onWasmInitSuccess"),this.wasmInstance=m.getInstance(),this.wasmInstance.initSimulation(),this.wasmInstance.setupStandardBalls(),this.scheduleOnce((function(){}),1)},i.handlerTouchEnd=function(e){console.log("touch end");var t=e.getUILocation();console.log("世界坐标:",t.x,t.y);var n=new c(t.x,t.y,0),i=this.node.getComponent(l).convertToNodeSpaceAR(n);console.log("节点本地坐标:",i.x,i.y,i.z);var o=i.multiplyScalar(1/this.physicsToScreenScale);if(console.log("物理坐标:",o.x,o.y,o.z),this.isAddingBall){this.isAddingBall=!1;var s=Math.floor(15*Math.random())+1;return console.log("Random ball number:",s),void this.wasmInstance.addBall(s,o.x,o.y)}var a=new d(o.x-this.cueBallPosition.x,o.y-this.cueBallPosition.y);console.log("方向:",a.x,a.y);var h=Math.atan2(a.y,a.x)*(180/Math.PI);h<0&&(h+=360),console.log("欧拉角:",h),this.angle=h},i.handlerAddButton=function(){this.angle+=.1},i.handlerMinusButton=function(){this.angle-=.1},i.handlerPlayButton=function(){this.node.getChildByName("Graphics").getComponent(u).clear();var e=this.node.getChildByName("powerSlider").getChildByName("Text").getComponent(r).string,t=this.node.getChildByName("spinTopSlider").getChildByName("Text").getComponent(r).string,n=this.node.getChildByName("spinZSlider").getChildByName("Text").getComponent(r).string;this.wasmInstance.executeCueStrike(0,Number(e),this.angle,Number(t),Number(n))},i.updateAimingLine=function(e){var t=this.node.getChildByName("Graphics").getComponent(u);if(t.lineWidth=4,t.strokeColor=new g(255,255,255,255),t.clear(),t.moveTo(e.startPoint.x*this.physicsToScreenScale,e.startPoint.y*this.physicsToScreenScale),t.lineTo(e.endPoint.x*this.physicsToScreenScale,e.endPoint.y*this.physicsToScreenScale),t.circle(e.endPoint.x*this.physicsToScreenScale,e.endPoint.y*this.physicsToScreenScale,e.radius*this.physicsToScreenScale-2),e.aimId>=0){var n=.1,i={x:e.endPoint.x+2*e.radius*e.normal.x,y:e.endPoint.y+2*e.radius*e.normal.y},o={x:e.endPoint.x+n*e.normal.x,y:e.endPoint.y+n*e.normal.y};t.moveTo(i.x*this.physicsToScreenScale,i.y*this.physicsToScreenScale),t.lineTo(o.x*this.physicsToScreenScale,o.y*this.physicsToScreenScale);var s={x:e.endPoint.x+n*e.tangent.x,y:e.endPoint.y+n*e.tangent.y};t.moveTo(e.endPoint.x*this.physicsToScreenScale,e.endPoint.y*this.physicsToScreenScale),t.lineTo(s.x*this.physicsToScreenScale,s.y*this.physicsToScreenScale)}t.moveTo(e.endPoint.x*this.physicsToScreenScale,e.endPoint.y*this.physicsToScreenScale),t.stroke()},i.calculateAimingPath=function(e,t){return this.wasmInstance?this.wasmInstance.calculateAimingPath(e,t):null},i.update=function(e){this.updateBallPositions(e),this.checkAllStoped()},i.updateBallPositions=function(e){if(this.wasmInstance){var t=this.wasmInstance.stepSimulation();if(t){var n=t.ballStates;t.frameCount;this.cueBallPosition=new d(n[0].x,n[0].y),this.allStoped=!0;for(var i=0;i<n.length;i++){var o=n[i],s=(o.id,this.ballNodes[o.number]);if(null!=s){s.setPosition(o.x,o.y,0);var a=o.rx,l=o.ry,h=o.rz;s.setRotationFromEuler(a,l,h),o.isInPocket?s.active=!1:(s.active=!0,0==o.vx&&0==o.vy||(this.allStoped=!1))}}}}},i.checkAllStoped=function(){if(this.allStoped&&this.ballNodes[0].active){var e=this.calculateAimingPath(0,this.angle);e&&this.updateAimingLine(e)}},n}(p))||B);n._RF.pop()}}}));

System.register("chunks:///_virtual/WasmLoader.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WasmWrapper.ts","./billiards_wasm.mjs_cjs=&original=.js","./billiards_wasm.js"],(function(n){var e,t,r,a,s,o,c,i,u,l;return{setters:[function(n){e=n.inheritsLoose,t=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){a=n.cclegacy,s=n._decorator,o=n.EventTarget,c=n.Component,i=n.resources},function(n){u=n.createWrappedModuleExports},null,function(n){l=n.default}],execute:function(){var p;a._RF.push({},"2cafcSsoI9AeoyagxwnjUgx","WasmLoader",void 0);var f=s.ccclass,m=n("WASM_EVENTS",{INIT_SUCCESS:"wasm-init-success"}),d=n("wasmEventTarget",new o),h=n("WasmGlobal",{instance:null,setInstance:function(n){this.instance=n,console.log("全局WASM实例已设置")},getInstance:function(){return this.instance},isLoaded:function(){return null!==this.instance}});n("WasmLoader",f("WasmLoader")(p=function(n){function a(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=n.call.apply(n,[this].concat(r))||this).wasmInstance=null,e}e(a,n);var s=a.prototype;return s.start=function(){var n=t(r().mark((function n(){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("使用JavaScript胶水代码加载WASM"),n.next=4,this.loadWithJavaScriptGlue();case 4:this.wasmInstance?(console.log("WASM模块加载成功"),d.emit(m.INIT_SUCCESS,this.wasmInstance),console.log("已发送WASM初始化成功事件")):console.error("WASM模块加载失败"),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("WASM加载过程中发生错误:",n.t0);case 10:case"end":return n.stop()}}),n,this,[[0,7]])})));return function(){return n.apply(this,arguments)}}(),s.loadWithJavaScriptGlue=function(){var n=t(r().mark((function n(){var e=this;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){try{i.load("wasm/billiards_wasm",(function(t,r){if(t)return console.error("无法加载WASM资源:",t),void n(!1);var a=r.nativeUrl;console.log("WASM文件URL:",a);var s={arguments_:[],locateFile:function(n){return n.endsWith(".wasm")?a:n},onRuntimeInitialized:function(){console.log("WASM运行时已初始化")},AL:{disableAudio:!0}};try{l(s).then((function(t){console.log("WASM模块实例化完成:",t),e.wasmInstance=u(t),h.setInstance(e.wasmInstance),n(!0)}))}catch(t){console.error("WASM初始化失败:",t)}}))}catch(e){console.error("加载JavaScript胶水代码失败:",e),n(!1)}})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),a}(c))||p);a._RF.pop()}}}));

System.register("chunks:///_virtual/WasmWrapper.ts",["cc"],(function(e){var r;return{setters:[function(e){r=e.cclegacy}],execute:function(){e("createWrappedModuleExports",(function(e){console.log("创建Module包装对象，可用函数:",Object.keys(e).filter((function(r){return"function"==typeof e[r]})));var r=Object.keys({_initSimulation:"initSimulation",_cleanupSimulation:"cleanupSimulation",_stepSimulation:"stepSimulation",_executeCueStrike:"executeCueStrike",_getPhysicsConfig:"getPhysicsConfig",_getTableConfig:"getTableConfig",_getBoundarySegments:"getBoundarySegments",_setupStandardBalls:"setupStandardBalls",_addBall:"addBall",_clearBalls:"clearBalls",_resetCueBall:"resetCueBall"}).filter((function(r){return"function"!=typeof e[r]}));r.length>0&&console.warn("Module缺少以下函数:",r);var n=e.HEAPF64;e.HEAP32,e.HEAPU8;return{initSimulation:function(){"function"==typeof e._initSimulation?e._initSimulation():console.error("未找到initSimulation函数")},setupStandardBalls:function(){"function"==typeof e._setupStandardBalls?e._setupStandardBalls():console.error("未找到setupStandardBalls函数")},addBall:function(r,n,o){var u=BigInt(Math.floor(r)),l=BigInt(Math.floor(n*t)),a=BigInt(Math.floor(o*t));"function"==typeof e._addBall?e._addBall(u,l,a):console.error("未找到addBall函数")},resetCueBall:function(r,n){var o=BigInt(Math.floor(r*t)),u=BigInt(Math.floor(n*t));"function"==typeof e._resetCueBall?e._resetCueBall(o,u):console.error("未找到resetCueBall函数")},clearBalls:function(){"function"==typeof e._clearBalls?e._clearBalls():console.error("未找到clearBalls函数")},executeCueStrike:function(r,n,o,u,l){var a=BigInt(Math.floor(r)),i=BigInt(Math.floor(n*t)),c=BigInt(Math.floor(o*t)),f=BigInt(Math.floor(u*t)),s=BigInt(Math.floor(l*t));"function"==typeof e._executeCueStrike?e._executeCueStrike(a,i,c,f,s):console.error("未找到executeCueStrike函数")},calculateAimingPath:function(r,o){var u=BigInt(Math.floor(r)),l=BigInt(Math.floor(10*o));if("function"==typeof e._calculateAimingPath){var a=e._calculateAimingPath(u,l);if(!a)return console.error("获取瞄准路径缓冲区指针为空"),null;var i=new BigInt64Array(n.buffer),c=Math.floor(a/8);return{startPoint:{x:Number(i[c])/t,y:Number(i[c+1])/t},endPoint:{x:Number(i[c+2])/t,y:Number(i[c+3])/t},normal:{x:Number(i[c+4])/t,y:Number(i[c+5])/t},tangent:{x:Number(i[c+6])/t,y:Number(i[c+7])/t},radius:Number(i[c+8])/t,aimId:Number(i[c+9])}}return console.error("未找到calculateAimingPath函数"),null},cleanupSimulation:function(){"function"==typeof e._cleanupSimulation?e._cleanupSimulation():console.error("未找到cleanupSimulation函数")},stepSimulation:function(){if("function"==typeof e._stepSimulation){var r=e._stepSimulation();if(!r)return console.error("获取状态缓冲区指针为空"),null;for(var o=new BigInt64Array(n.buffer),u=Math.floor(r/8),l=[],a=0,i=Number(o[u+a++]),c=Number(o[u+a++]),f=0;f<c;f++){var s={id:Number(o[u+a]),number:Number(o[u+a+1]),x:Number(o[u+a+2])/t,y:Number(o[u+a+3])/t,vx:Number(o[u+a+4])/t,vy:Number(o[u+a+5])/t,rx:Number(o[u+a+6]),ry:Number(o[u+a+7]),rz:Number(o[u+a+8]),isInPocket:0!==Number(o[u+a+9])};l.push(s),a+=10}return{ballStates:l,frameCount:i}}console.error("未找到stepSimulation函数")},getPhysicsConfig:function(){try{if("function"!=typeof e._getPhysicsConfig)return console.error("未找到getPhysicsConfig函数"),null;var r=e._getPhysicsConfig();if(!r)return console.error("获取物理配置指针为空"),null;var o=new BigInt64Array(n.buffer),u=Math.floor(r/8);return{BALL_RESTITUTION:Number(o[u])/t,CUSHION_RESTITUTION:Number(o[u+1])/t,FRICTION_COEFFICIENT:Number(o[u+2])/t,ROLLING_FRICTION_COEFFICIENT:Number(o[u+3])/t,BALL_TO_BALL_FRICTION_COEFFICIENT:Number(o[u+4])/t}}catch(e){return console.error("获取物理配置时出错:",e),null}},getTableConfig:function(){try{if("function"!=typeof e._getTableConfig)return console.error("未找到getTableConfig函数"),null;var r=e._getTableConfig();if(!r)return console.error("获取台球桌配置指针为空"),null;var o=new BigInt64Array(n.buffer),u=Math.floor(r/8);return{MAX_BALLS:Number(o[u]),WIDTH:Number(o[u+1])/t,HEIGHT:Number(o[u+2])/t,BALL_RADIUS:Number(o[u+3])/t}}catch(e){return console.error("获取台球桌配置时出错:",e),null}},getBoundarySegments:function(){try{if("function"!=typeof e._getBoundarySegments)return console.error("获取边界线段所需函数不存在"),null;var r=e._getBoundarySegments();if(!r)return console.error("获取边界线段数组指针为空"),null;var o=new BigInt64Array(n.buffer),u=Math.floor(r/8);if(u+168>=o.length)return console.error("边界线段数组指针超出内存范围"),null;for(var l=[],a=0;a<24;a++){var i=7*a,c=Number(o[u+i+5]);if(0===c&&a>0)break;var f={id:c,start:{x:Number(o[u+i+0])/t,y:Number(o[u+i+1])/t},end:{x:Number(o[u+i+2])/t,y:Number(o[u+i+3])/t},type:Number(o[u+i+4]),pocketId:Number(o[u+i+6])};l.push(f)}return l}catch(e){return console.error("解析边界线段时出错:",e),null}}}})),r._RF.push({},"1a868G03bxPUbp+jeKBqYbN","WasmWrapper",void 0);var t=1e7;r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});